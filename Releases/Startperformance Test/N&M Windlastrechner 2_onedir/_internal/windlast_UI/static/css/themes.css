/* ---------- 1. Light-Defaults (Fallback vor theme.js) ---------- */
:root {
  /* ====================
  MASTER
  ==================== */

  /* Neutrals */
  --master-bg: #ffffff;              /* war: --bg */
  --master-surface: #ffffff;         /* hell */
  --master-surface-2: #f3f3f3;       /* mittel */
  --master-surface-3: #c6c6c6;       /* dunkel */
  --master-border: #dddddd;          /* war: --border */
  --master-text: #111111;            /* war: --text */
  --master-muted: #555555;           /* war: --muted */
  --master-link: #0066cc;            /* war: --link */

  /* Brand / Accent */
  --master-accent: #fdc300;          /* intensiver Akzent */
  --master-accent-2: #fdc300;        /* etwas abgedunkelt für Flächen */
  --master-accent-3: #575756;        /* für Linien, Konturen */
  --master-on-accent: #3c3c3b;       /* Text auf Akzentflächen */

  --master-hit-bg: rgba(255, 215, 0, 0.35);
  --master-hit-border: rgba(180, 140, 0, 0.8);

  /* Systematic overlays (für viele rgba-Flächen) */
  --master-overlay-rgb: 0, 0, 0;
  --master-overlay-1: rgba(0, 0, 0, 0.02);
  --master-overlay-2: rgba(0, 0, 0, 0.04);
  --master-overlay-3: rgba(0, 0, 0, 0.08);
  --master-overlay-4: rgba(0, 0, 0, 0.15);

  /* Shadows (optional, aber praktisch als Master) */
  --master-shadow-soft: 0 8px 20px rgba(0, 0, 0, 0.25);
  --master-shadow-strong: 0 10px 30px rgba(0, 0, 0, 0.25);

  /* Semantik - Ergebnisse */
  --master-ok-bg: rgba(16, 185, 129, 0.18);
  --master-ok-fg: #10b981;

  --master-bad-bg: rgba(239, 68, 68, 0.18);
  --master-bad-fg: #ef4444;

  /* Semantik – Meldungen */
  --master-info-bg: rgba(100, 100, 100, 0.12);
  --master-info-fg: #555555;

  --master-hint-bg: rgba(45, 108, 223, 0.12);
  --master-hint-fg: #2d6cdf;

  --master-warning-bg: rgba(240, 173, 78, 0.15);
  --master-warning-fg: #d99000;

  --master-error-bg: rgba(255, 107, 107, 0.15);
  --master-error-fg: #ff4c4c;

  /* Semantik – Zwischenergebnisse (getrennt, auch wenn gleiche Farbe) */
  --master-irrelevant-bg: rgba(100, 100, 100, 0.08);
  --master-irrelevant-fg: #555555;

  --master-entscheidungsrelevant-bg: rgba(45, 108, 223, 0.12);
  --master-entscheidungsrelevant-fg: #2d6cdf;

  --master-relevant-bg: rgba(46, 204, 93, 0.322);
  --master-relevant-fg: #2e8b57;

  /* Logo */
  --company-logo: url("/static/media/NM_Logo_hell.png"); 

  /* ====================
  SPEZIFISCH
  ==================== */

  /* Base */
  --bg: var(--master-bg);
  --text: var(--master-text);
  --panel: var(--master-surface);
  --border: var(--master-border);
  --muted: var(--master-muted);
  --link: var(--master-link);

  /* Controls & Tabs */
  --button-bg: var(--master-accent-2);
  --button-border: var(--master-accent);
  --button-text: var(--master-on-accent);
  --tab-bg: var(--master-surface-2);
  --tab-active-border: var(--master-accent);

  /* Checkboxen */
  --checkbox-bg: var(--master-surface);
  --checkbox-border: var(--master-border);
  --checkbox-check: var(--master-accent);
  --checkbox-disabled-bg: var(--master-surface-3);
  --checkbox-disabled-border: var(--master-border);

  /* Fokus-Ring */
  --focus-ring: var(--master-accent);
  --focus-ring-soft: color-mix(in srgb, var(--focus-ring) 30%, transparent);

  /* Tables & Fields */
  --table-head: var(--master-surface-2);
  --field-bg: var(--master-surface);
  --field-border: var(--master-border);

  /* Status / Validation */
  --danger: var(--master-error-fg);

  /* Warnung / Auto-Änderung (Dropdown Filter) */
  --warn-border: var(--master-warning-fg);
  --warn-bg: var(--master-warning-bg);
  --warn-fg: var(--master-warning-fg);

  /* Results stale (Ergebnisse veraltet) */
  --stale-border: var(--master-warning-fg);
  --stale-bg: var(--master-warning-bg);

  /* Safety-Zellen (OK / kritisch) */
  --ok-bg: var(--master-ok-bg);
  --bad-bg: var(--master-bad-bg);

  /* Meldungen (Tooltips, Modals) */
  --msg-error-bg: var(--master-error-bg);
  --msg-error-fg: var(--master-error-fg);
  --msg-warn-bg: var(--master-warning-bg);
  --msg-warn-fg: var(--master-warning-fg);
  --msg-hint-bg: var(--master-hint-bg);
  --msg-hint-fg: var(--master-hint-fg);
  --msg-info-bg: var(--master-info-bg);
  --msg-info-fg: var(--master-info-fg);

  /* Badges (Zählblasen / Status im Tabellenkopf) */
  --badge-error-bg: var(--msg-error-bg);
  --badge-error-fg: var(--msg-error-fg);
  --badge-error-border: var(--master-error-fg);

  --badge-warn-bg: var(--msg-warn-bg);
  --badge-warn-fg: var(--msg-warn-fg);
  --badge-warn-border: var(--master-warning-fg);

  --badge-hint-bg: var(--msg-hint-bg);
  --badge-hint-fg: var(--msg-hint-fg);
  --badge-hint-border: var(--master-hint-fg);

  --badge-info-bg: var(--msg-info-bg);
  --badge-info-fg: var(--msg-info-fg);
  --badge-info-border: var(--master-info-fg);

  /* Rollenfarben (Key/Relevant/Irrelevant) */
  --role-key-bg: var(--master-entscheidungsrelevant-bg);
  --role-key-fg: var(--master-entscheidungsrelevant-fg);
  --role-rel-bg: var(--master-relevant-bg);
  --role-rel-fg: var(--master-relevant-fg);
  --role-irr-bg: var(--master-irrelevant-bg);
  --role-irr-fg: var(--master-irrelevant-fg);

  /* Wiki */
  --wiki-header-bg: var(--master-overlay-2);
  --wiki-header-border: var(--master-overlay-3);
  --wiki-header-hover-bg: var(--master-overlay-2);

  --wiki-faq-bg: var(--master-overlay-1);
  --wiki-faq-border: var(--master-overlay-4);
  --wiki-faq-hover-bg: var(--master-overlay-2);

  --wiki-include-border: var(--master-overlay-3);

  --wiki-search-bg: var(--master-surface);
  --wiki-search-border: var(--master-border);
  --wiki-search-shadow: var(--master-shadow-soft);
  --wiki-search-title: var(--master-text);
  --wiki-search-snippet: var(--master-muted);

  --wiki-search-hit-bg: var(--master-hit-bg);
  --wiki-search-hit-border: var(--master-hit-border);

  --wiki-search-muted-pill-bg: var(--master-overlay-1);
  --wiki-search-muted-pill-fg: var(--master-muted);

  --wiki-search-breadcrumb: var(--master-muted);
  --wiki-search-breadcrumb-size: 0.72rem;
  --wiki-search-hit-fg: var(--master-text);

  /* Help */
  --help-icon-border: var(--master-overlay-4);
  --help-icon-bg: var(--master-overlay-1);
  --help-icon-hover-bg: var(--master-overlay-3);

  --help-popover-bg: var(--master-surface);
  --help-popover-border: var(--master-border);
  --help-popover-head-bg: var(--wiki-header-bg);
  --help-popover-close-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-muted: var(--master-muted);
  --help-popover-shadow: var(--master-shadow-strong);

  --help-popover-copy-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-copy-border: var(--master-border);
  --help-popover-copy-text: var(--master-text);

  --help-popover-copy-ok-bg: var(--master-ok-bg);
  --help-popover-copy-ok-border: var(--master-ok-fg);

  --help-popover-copy-err-bg: var(--master-bad-bg);
  --help-popover-copy-err-border: var(--master-bad-fg);

  --help-figure-border: var(--master-border);
  --help-figure-bg: var(--master-surface);
  --help-figure-muted: var(--master-muted);

  /* --- Preview (Three.js) --- */
  --preview-bg: var(--master-bg);
  
  --preview-line-color: var(--master-accent-3);
  --preview-plate-fill: var(--master-surface);
  --preview-plate-fill-gummi: var(var(--master-accent));
  --preview-wall-fill: var(--master-surface-3);

  --preview-dimension-line: var(--master-accent);
  --preview-dimension-text-fill: var(--master-on-accent);
  --preview-dimension-text-outline: var(--master-accent-2);
  --preview-dimension-text-bg: var(--master-accent-2);
  --preview-dimension-text-border: var(--master-accent);
}

/* ---------- 2. EXPLIZIT: Light-Theme (Angleich an :root) ---------- */
[data-theme="light"] {
  /* ====================
  MASTER
  ==================== */

  /* Neutrals */
  --master-bg: #ffffff;              /* war: --bg */
  --master-surface: #ffffff;         /* hell */
  --master-surface-2: #f3f3f3;       /* mittel */
  --master-surface-3: #c6c6c6;       /* dunkel */
  --master-border: #dddddd;          /* war: --border */
  --master-text: #111111;            /* war: --text */
  --master-muted: #555555;           /* war: --muted */
  --master-link: #0066cc;            /* war: --link */

  /* Brand / Accent */
  --master-accent: #fdc300;          /* intensiver Akzent */
  --master-accent-2: #fdc300;        /* etwas abgedunkelt für Flächen */
  --master-accent-3: #575756;        /* für Linien, Konturen */
  --master-on-accent: #3c3c3b;       /* Text auf Akzentflächen */

  --master-hit-bg: rgba(255, 215, 0, 0.35);
  --master-hit-border: rgba(180, 140, 0, 0.8);

  /* Systematic overlays (für viele rgba-Flächen) */
  --master-overlay-rgb: 0, 0, 0;
  --master-overlay-1: rgba(0, 0, 0, 0.02);
  --master-overlay-2: rgba(0, 0, 0, 0.04);
  --master-overlay-3: rgba(0, 0, 0, 0.08);
  --master-overlay-4: rgba(0, 0, 0, 0.15);

  /* Shadows (optional, aber praktisch als Master) */
  --master-shadow-soft: 0 8px 20px rgba(0, 0, 0, 0.25);
  --master-shadow-strong: 0 10px 30px rgba(0, 0, 0, 0.25);

  /* Semantik - Ergebnisse */
  --master-ok-bg: rgba(16, 185, 129, 0.18);
  --master-ok-fg: #10b981;

  --master-bad-bg: rgba(239, 68, 68, 0.18);
  --master-bad-fg: #ef4444;

  /* Semantik – Meldungen */
  --master-info-bg: rgba(100, 100, 100, 0.12);
  --master-info-fg: #555555;

  --master-hint-bg: rgba(45, 108, 223, 0.12);
  --master-hint-fg: #2d6cdf;

  --master-warning-bg: rgba(240, 173, 78, 0.15);
  --master-warning-fg: #d99000;

  --master-error-bg: rgba(255, 107, 107, 0.15);
  --master-error-fg: #ff4c4c;

  /* Semantik – Zwischenergebnisse (getrennt, auch wenn gleiche Farbe) */
  --master-irrelevant-bg: rgba(100, 100, 100, 0.08);
  --master-irrelevant-fg: #555555;

  --master-entscheidungsrelevant-bg: rgba(45, 108, 223, 0.12);
  --master-entscheidungsrelevant-fg: #2d6cdf;

  --master-relevant-bg: rgba(46, 204, 93, 0.322);
  --master-relevant-fg: #2e8b57;

  /* Logo */
  --company-logo: url("/static/media/NM_Logo_hell.png"); 

  /* ====================
  SPEZIFISCH
  ==================== */

  /* Base */
  --bg: var(--master-bg);
  --text: var(--master-text);
  --panel: var(--master-surface);
  --border: var(--master-border);
  --muted: var(--master-muted);
  --link: var(--master-link);

  /* Controls & Tabs */
  --button-bg: var(--master-accent-2);
  --button-border: var(--master-accent);
  --button-text: var(--master-on-accent);
  --tab-bg: var(--master-surface-2);
  --tab-active-border: var(--master-accent);

  /* Checkboxen */
  --checkbox-bg: var(--master-surface);
  --checkbox-border: var(--master-border);
  --checkbox-check: var(--master-accent);
  --checkbox-disabled-bg: var(--master-surface-3);
  --checkbox-disabled-border: var(--master-border);

  /* Fokus-Ring */
  --focus-ring: var(--master-accent);
  --focus-ring-soft: color-mix(in srgb, var(--focus-ring) 30%, transparent);

  /* Tables & Fields */
  --table-head: var(--master-surface-2);
  --field-bg: var(--master-surface);
  --field-border: var(--master-border);

  /* Status / Validation */
  --danger: var(--master-error-fg);

  /* Warnung / Auto-Änderung (Dropdown Filter) */
  --warn-border: var(--master-warning-fg);
  --warn-bg: var(--master-warning-bg);
  --warn-fg: var(--master-warning-fg);

  /* Results stale (Ergebnisse veraltet) */
  --stale-border: var(--master-warning-fg);
  --stale-bg: var(--master-warning-bg);

  /* Safety-Zellen (OK / kritisch) */
  --ok-bg: var(--master-ok-bg);
  --bad-bg: var(--master-bad-bg);

  /* Meldungen (Tooltips, Modals) */
  --msg-error-bg: var(--master-error-bg);
  --msg-error-fg: var(--master-error-fg);
  --msg-warn-bg: var(--master-warning-bg);
  --msg-warn-fg: var(--master-warning-fg);
  --msg-hint-bg: var(--master-hint-bg);
  --msg-hint-fg: var(--master-hint-fg);
  --msg-info-bg: var(--master-info-bg);
  --msg-info-fg: var(--master-info-fg);

  /* Badges (Zählblasen / Status im Tabellenkopf) */
  --badge-error-bg: var(--msg-error-bg);
  --badge-error-fg: var(--msg-error-fg);
  --badge-error-border: var(--master-error-fg);

  --badge-warn-bg: var(--msg-warn-bg);
  --badge-warn-fg: var(--msg-warn-fg);
  --badge-warn-border: var(--master-warning-fg);

  --badge-hint-bg: var(--msg-hint-bg);
  --badge-hint-fg: var(--msg-hint-fg);
  --badge-hint-border: var(--master-hint-fg);

  --badge-info-bg: var(--msg-info-bg);
  --badge-info-fg: var(--msg-info-fg);
  --badge-info-border: var(--master-info-fg);

  /* Rollenfarben (Key/Relevant/Irrelevant) */
  --role-key-bg: var(--master-entscheidungsrelevant-bg);
  --role-key-fg: var(--master-entscheidungsrelevant-fg);
  --role-rel-bg: var(--master-relevant-bg);
  --role-rel-fg: var(--master-relevant-fg);
  --role-irr-bg: var(--master-irrelevant-bg);
  --role-irr-fg: var(--master-irrelevant-fg);

  /* Wiki */
  --wiki-header-bg: var(--master-overlay-2);
  --wiki-header-border: var(--master-overlay-3);
  --wiki-header-hover-bg: var(--master-overlay-2);

  --wiki-faq-bg: var(--master-overlay-1);
  --wiki-faq-border: var(--master-overlay-4);
  --wiki-faq-hover-bg: var(--master-overlay-2);

  --wiki-include-border: var(--master-overlay-3);

  --wiki-search-bg: var(--master-surface);
  --wiki-search-border: var(--master-border);
  --wiki-search-shadow: var(--master-shadow-soft);
  --wiki-search-title: var(--master-text);
  --wiki-search-snippet: var(--master-muted);

  --wiki-search-hit-bg: var(--master-hit-bg);
  --wiki-search-hit-border: var(--master-hit-border);

  --wiki-search-muted-pill-bg: var(--master-overlay-1);
  --wiki-search-muted-pill-fg: var(--master-muted);

  --wiki-search-breadcrumb: var(--master-muted);
  --wiki-search-breadcrumb-size: 0.72rem;
  --wiki-search-hit-fg: var(--master-text);

  /* Help */
  --help-icon-border: var(--master-overlay-4);
  --help-icon-bg: var(--master-overlay-1);
  --help-icon-hover-bg: var(--master-overlay-3);

  --help-popover-bg: var(--master-surface);
  --help-popover-border: var(--master-border);
  --help-popover-head-bg: var(--wiki-header-bg);
  --help-popover-close-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-muted: var(--master-muted);
  --help-popover-shadow: var(--master-shadow-strong);

  --help-popover-copy-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-copy-border: var(--master-border);
  --help-popover-copy-text: var(--master-text);

  --help-popover-copy-ok-bg: var(--master-ok-bg);
  --help-popover-copy-ok-border: var(--master-ok-fg);

  --help-popover-copy-err-bg: var(--master-bad-bg);
  --help-popover-copy-err-border: var(--master-bad-fg);

  --help-figure-border: var(--master-border);
  --help-figure-bg: var(--master-surface);
  --help-figure-muted: var(--master-muted);

  /* --- Preview (Three.js) --- */
  --preview-bg: var(--master-bg);
  
  --preview-line-color: var(--master-accent-3);
  --preview-plate-fill: var(--master-surface);
  --preview-plate-fill-gummi: var(var(--master-accent));
  --preview-wall-fill: var(--master-surface-3);

  --preview-dimension-line: var(--master-accent);
  --preview-dimension-text-fill: var(--master-on-accent);
  --preview-dimension-text-outline: var(--master-accent-2);
  --preview-dimension-text-bg: var(--master-accent-2);
  --preview-dimension-text-border: var(--master-accent);
}

/* ---------- 3. EXPLIZIT: Dark-Theme ---------- */
[data-theme="dark"] {
  /* ====================
  MASTER
  ==================== */

  /* Neutrals */
  --master-bg: #0b0e13;              /* war: --bg */
  --master-surface: #191919;         /* hell */
  --master-surface-2: #333333;       /* mittel */
  --master-surface-3: #706f6f;       /* dunkel */
  --master-border: #414141;          /* war: --border */
  --master-text: #e8eef9;            /* war: --text */
  --master-muted: #a6b1c2;           /* war: --muted */
  --master-link: #6aa2ff;            /* war: --link */

  /* Brand / Accent */
  --master-accent: #fed462;          /* intensiver Akzent */
  --master-accent-2: #191919;        /* etwas abgedunkelt für Flächen */
  --master-accent-3: #c6c6c6;        /* für Linien, Konturen */
  --master-on-accent: #fed462;       /* Text auf Akzentflächen */

  --master-hit-bg: rgba(255, 215, 0, 0.35);
  --master-hit-border: rgba(180, 140, 0, 0.8);

  /* Systematic overlays */
  --master-overlay-rgb: 255, 255, 255;
  --master-overlay-1: rgba(255, 255, 255, 0.02);
  --master-overlay-2: rgba(255, 255, 255, 0.04);
  --master-overlay-3: rgba(255, 255, 255, 0.08);
  --master-overlay-4: rgba(255, 255, 255, 0.15);

  /* Shadows */
  --master-shadow-soft: 0 10px 30px rgba(0, 0, 0, 0.25);
  --master-shadow-strong: 0 10px 28px rgba(0, 0, 0, 0.6);

  /* Semantik - Ergebnisse */
  --master-ok-bg: rgba(16, 185, 129, 0.25);
  --master-ok-fg: #10b981;

  --master-bad-bg: rgba(239, 68, 68, 0.25);
  --master-bad-fg: #ef4444;

  /* Semantik – Meldungen */
  --master-info-bg: rgba(120, 120, 150, 0.25);
  --master-info-fg: #e0e4ec;

  --master-hint-bg: rgba(21, 110, 255, 0.349);
  --master-hint-fg: #c3d8ff;

  --master-warning-bg: rgba(240, 157, 41, 0.2);
  --master-warning-fg: #ffb12c;

  --master-error-bg: rgba(255, 50, 50, 0.2);
  --master-error-fg: #df2c2c;

  /* Semantik – Zwischenergebnisse (getrennt, auch wenn gleiche Farbe) */
  --master-irrelevant-bg: rgba(255, 255, 255, 0.144);
  --master-irrelevant-fg: #c3c8d4;

  --master-entscheidungsrelevant-bg: rgba(45, 108, 223, 0.20);
  --master-entscheidungsrelevant-fg: #c3d8ff;

  --master-relevant-bg: rgba(46, 204, 93, 0.247);
  --master-relevant-fg: #b7ffd3;

  /* Logo */
  --company-logo: url("/static/media/NM_Logo_dunkel.png"); 

  /* ====================
  SPEZIFISCH
  ==================== */

  /* Base */
  --bg: var(--master-bg);
  --text: var(--master-text);
  --panel: var(--master-surface);
  --border: var(--master-border);
  --muted: var(--master-muted);
  --link: var(--master-link);

  /* Controls & Tabs */
  --button-bg: var(--master-accent-2);
  --button-border: var(--master-accent);
  --button-text: var(--master-on-accent);
  --tab-bg: var(--master-surface-2);
  --tab-active-border: var(--master-accent);

  /* Checkboxen */
  --checkbox-bg: var(--master-surface);
  --checkbox-border: var(--master-border);
  --checkbox-check: var(--master-accent);
  --checkbox-disabled-bg: var(--master-surface-3);
  --checkbox-disabled-border: var(--master-border);

  /* Fokus-Ring */
  --focus-ring: var(--master-accent);
  --focus-ring-soft: color-mix(in srgb, var(--focus-ring) 30%, transparent);

  /* Tables & Fields */
  --table-head: var(--master-surface-2);
  --field-bg: var(--master-surface);
  --field-border: var(--master-border);

  /* Status / Validation */
  --danger: var(--master-error-fg);

  /* Warnung / Auto-Änderung (Dropdown Filter) */
  --warn-border: var(--master-warning-fg);
  --warn-bg: var(--master-warning-bg);
  --warn-fg: var(--master-warning-fg);

  /* Results stale (Ergebnisse veraltet) */
  --stale-border: var(--master-warning-fg);
  --stale-bg: var(--master-warning-bg);

  /* Safety-Zellen (OK / kritisch) */
  --ok-bg: var(--master-ok-bg);
  --bad-bg: var(--master-bad-bg);

  /* Meldungen (Tooltips, Modals) */
  --msg-error-bg: var(--master-error-bg);
  --msg-error-fg: var(--master-error-fg);
  --msg-warn-bg: var(--master-warning-bg);
  --msg-warn-fg: var(--master-warning-fg);
  --msg-hint-bg: var(--master-hint-bg);
  --msg-hint-fg: var(--master-hint-fg);
  --msg-info-bg: var(--master-info-bg);
  --msg-info-fg: var(--master-info-fg);

  /* Badges (Zählblasen / Status im Tabellenkopf) */
  --badge-error-bg: var(--msg-error-bg);
  --badge-error-fg: var(--msg-error-fg);
  --badge-error-border: var(--master-error-fg);

  --badge-warn-bg: var(--msg-warn-bg);
  --badge-warn-fg: var(--msg-warn-fg);
  --badge-warn-border: var(--master-warning-fg);

  --badge-hint-bg: var(--msg-hint-bg);
  --badge-hint-fg: var(--msg-hint-fg);
  --badge-hint-border: var(--master-hint-fg);

  --badge-info-bg: var(--msg-info-bg);
  --badge-info-fg: var(--msg-info-fg);
  --badge-info-border: var(--master-info-fg);

  /* Rollenfarben (Key/Relevant/Irrelevant) */
  --role-key-bg: var(--master-entscheidungsrelevant-bg);
  --role-key-fg: var(--master-entscheidungsrelevant-fg);
  --role-rel-bg: var(--master-relevant-bg);
  --role-rel-fg: var(--master-relevant-fg);
  --role-irr-bg: var(--master-irrelevant-bg);
  --role-irr-fg: var(--master-irrelevant-fg);

  /* Wiki */
  --wiki-header-bg: var(--master-overlay-2);
  --wiki-header-border: var(--master-overlay-3);
  --wiki-header-hover-bg: var(--master-overlay-2);

  --wiki-faq-bg: var(--master-overlay-1);
  --wiki-faq-border: var(--master-overlay-4);
  --wiki-faq-hover-bg: var(--master-overlay-2);

  --wiki-include-border: var(--master-overlay-3);

  --wiki-search-bg: var(--master-surface);
  --wiki-search-border: var(--master-border);
  --wiki-search-shadow: var(--master-shadow-soft);
  --wiki-search-title: var(--master-text);
  --wiki-search-snippet: var(--master-muted);

  --wiki-search-hit-bg: var(--master-hit-bg);
  --wiki-search-hit-border: var(--master-hit-border);

  --wiki-search-muted-pill-bg: var(--master-overlay-1);
  --wiki-search-muted-pill-fg: var(--master-muted);

  --wiki-search-breadcrumb: var(--master-muted);
  --wiki-search-breadcrumb-size: 0.72rem;
  --wiki-search-hit-fg: var(--master-text);

  /* Help */
  --help-icon-border: var(--master-overlay-4);
  --help-icon-bg: var(--master-overlay-1);
  --help-icon-hover-bg: var(--master-overlay-3);

  --help-popover-bg: var(--master-surface);
  --help-popover-border: var(--master-border);
  --help-popover-head-bg: var(--wiki-header-bg);
  --help-popover-close-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-muted: var(--master-muted);
  --help-popover-shadow: var(--master-shadow-strong);

  --help-popover-copy-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-copy-border: var(--master-border);
  --help-popover-copy-text: var(--master-text);

  --help-popover-copy-ok-bg: var(--master-ok-bg);
  --help-popover-copy-ok-border: var(--master-ok-fg);

  --help-popover-copy-err-bg: var(--master-bad-bg);
  --help-popover-copy-err-border: var(--master-bad-fg);

  --help-figure-border: var(--master-border);
  --help-figure-bg: var(--master-surface);
  --help-figure-muted: var(--master-muted);

  /* --- Preview (Three.js) --- */
  --preview-bg: var(--master-bg);
  
  --preview-line-color: var(--master-accent-3);
  --preview-plate-fill: var(--master-surface);
  --preview-plate-fill-gummi: var(var(--master-accent));
  --preview-wall-fill: var(--master-surface-3);

  --preview-dimension-line: var(--master-accent);
  --preview-dimension-text-fill: var(--master-on-accent);
  --preview-dimension-text-outline: var(--master-accent-2);
  --preview-dimension-text-bg: var(--master-accent-2);
  --preview-dimension-text-border: var(--master-accent);
}

/* ---------- 4. EXPLIZIT: Special-Theme ---------- */
[data-theme="special"] {
  /* --- Logo --- */
  --company-logo: url("/static/media/NM_Logo_dunkel.png"); 

  /* Surfaces & Text */
  --bg: #07050e;
  --panel: rgba(25, 12, 45, 0.72);
  --panel-alt: rgba(35, 14, 60, 0.78);

  /* Text: bewusst bunter/kontrastreicher */
  --text: #fff2ff;
  --muted: #7fe7ff;             /* "muted" ist hier absichtlich nicht grau */
  --link: #ff5cff;              /* knallig */

  /* Borders: kräftig + farbig */
  --border: rgba(140, 90, 255, 0.55);
  --field-border: rgba(255, 92, 255, 0.55);

  /* Controls */
  --field-bg: rgba(10, 6, 20, 0.55);

  --button-bg: #ff5cff;         /* magenta */
  --button-text: #07050e;

  --tab-bg: rgba(10, 6, 20, 0.45);
  --tab-active-border: #7fe7ff; /* cyan */

  /* Checkboxen */
  --checkbox-bg: rgba(10, 6, 20, 0.55);
  --checkbox-border: rgba(140, 90, 255, 0.55);
  --checkbox-check: #ff5cff;
  --checkbox-disabled-bg: rgba(10, 6, 20, 0.30);
  --checkbox-disabled-border: rgba(140, 90, 255, 0.30);

  /* Tables */
  --table-head: rgba(10, 6, 20, 0.65);

  /* Status */
  --danger: #ff3b6b;
  --warning: #ffb12c;
  --success: #2dff9a;

  /* --- Warnung / Auto-Änderung (Dropdown Filter) --- */
  --warn-border: rgba(255, 177, 44, 0.65);
  --warn-bg: rgba(255, 177, 44, 0.18);
  --warn-fg: #ffe1a8;

  /* Safety-Zellen (deutlich bunter) */
  --ok-bg: rgba(45, 255, 154, 0.18);
  --bad-bg: rgba(255, 59, 107, 0.20);

  /* Meldungen */
  --msg-error-bg: rgba(255, 59, 107, 0.18);
  --msg-error-fg: #ff9ab3;

  --msg-warn-bg: rgba(255, 177, 44, 0.18);
  --msg-warn-fg: #ffe1a8;

  --msg-hint-bg: rgba(127, 231, 255, 0.18);
  --msg-hint-fg: #bdf6ff;

  --msg-info-bg: rgba(140, 90, 255, 0.16);
  --msg-info-fg: #e3d6ff;

  /* Badges */
  --badge-error-bg: var(--msg-error-bg);
  --badge-error-fg: var(--msg-error-fg);
  --badge-error-border: rgba(255, 59, 107, 0.65);

  --badge-warn-bg: var(--msg-warn-bg);
  --badge-warn-fg: var(--msg-warn-fg);
  --badge-warn-border: rgba(255, 177, 44, 0.65);

  --badge-hint-bg: var(--msg-hint-bg);
  --badge-hint-fg: var(--msg-hint-fg);
  --badge-hint-border: rgba(127, 231, 255, 0.65);

  --badge-info-bg: var(--msg-info-bg);
  --badge-info-fg: var(--msg-info-fg);
  --badge-info-border: rgba(140, 90, 255, 0.65);

  /* Rollen-Highlighting (auch bunter) */
  --role-key-bg: rgba(255, 92, 255, 0.16);
  --role-key-fg: #ffd4ff;

  --role-rel-bg: rgba(127, 231, 255, 0.14);
  --role-rel-fg: #bdf6ff;

  --role-irr-bg: rgba(140, 90, 255, 0.12);
  --role-irr-fg: #e3d6ff;

  /* Wiki/Search etc. */
  --wiki-header-bg: rgba(255, 92, 255, 0.06);
  --wiki-header-border: rgba(127, 231, 255, 0.16);
  --wiki-header-hover-bg: rgba(127, 231, 255, 0.08);

  --wiki-faq-bg: rgba(140, 90, 255, 0.05);
  --wiki-faq-border: rgba(255, 92, 255, 0.18);
  --wiki-faq-hover-bg: rgba(255, 92, 255, 0.08);

  --wiki-include-border: rgba(127, 231, 255, 0.18);

  --help-icon-border: rgba(255, 92, 255, 0.40);
  --help-icon-bg: rgba(127, 231, 255, 0.08);
  --help-icon-hover-bg: rgba(255, 92, 255, 0.12);

  --wiki-search-bg: var(--panel);
  --wiki-search-border: var(--border);
  --wiki-search-shadow: 0 14px 40px rgba(0, 0, 0, 0.70);

  --wiki-search-title: var(--text);
  --wiki-search-snippet: var(--muted);

  --wiki-search-hit-bg: rgba(255, 92, 255, 0.16);
  --wiki-search-hit-border: rgba(127, 231, 255, 0.65);

  --wiki-search-muted-pill-bg: rgba(140, 90, 255, 0.10);
  --wiki-search-muted-pill-fg: var(--muted);

  --wiki-search-breadcrumb: var(--muted);
  --wiki-search-breadcrumb-size: 0.72rem;
  --wiki-search-hit-fg: var(--text);

  /* stale marker */
  --stale-border: #ff5cff;
  --stale-bg: rgba(255, 92, 255, 0.15);

  /* --- Help Contact Popover --- */
  --help-popover-bg: var(--panel);
  --help-popover-border: var(--border);
  --help-popover-head-bg: var(--wiki-header-bg);
  --help-popover-close-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-muted: var(--muted);
  --help-popover-shadow: 0 10px 30px rgba(0,0,0,0.25);

  --help-popover-copy-bg: transparent;
  --help-popover-copy-hover-bg: var(--wiki-header-hover-bg);
  --help-popover-copy-border: var(--border);
  --help-popover-copy-text: var(--text);

  --help-popover-copy-ok-bg: rgba(60, 179, 113, 0.18);
  --help-popover-copy-ok-border: rgba(60, 179, 113, 0.55);

  --help-popover-copy-err-bg: rgba(220, 20, 60, 0.18);
  --help-popover-copy-err-border: rgba(220, 20, 60, 0.55);

  /* --- Bilder --- */
  --help-figure-border: var(--border);
  --help-figure-bg: var(--panel);
  --help-figure-muted: var(--muted);

  /* --- Preview (Three.js) --- */
  --preview-bg: #07050e;
  
  --preview-line-color: #d8c7ff;
  --preview-plate-fill: #160a2a;
  --preview-plate-fill-gummi: #38bdf8;
  --preview-wall-fill: #24103f;

  --preview-dimension-line: #ff5cff;
  --preview-dimension-text-fill: #fff2ff;
  --preview-dimension-text-outline: #07050e;
  --preview-dimension-text-bg: #07050e;
  --preview-dimension-text-border: #7fe7ff;
}
